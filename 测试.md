# 测试

## 大纲
- 功能测试
- 单元测试
- 封包测试
- 压力测试
- 跑数据测试

## 功能测试

### 打鱼测试

### 暗送测试
#### 暗送池值累计测试
暗送池的增加只能是充值触发，充值

#### 暗送池消耗测试

暗送池的消耗是在正常捕获失败时赠送一次暗送捕获次数，暗送捕获成功后消耗鱼价值的池子值。

捕获流程的伪代码描述如下:
```text
捕获函数(captureProbability){
  A.尝试正常捕获(倍数/FishValue 概率，单倍模式倍数值是1，双倍模式下倍数是2)
  尝试成功则捕获成功，并结束return，尝试失败则继续执行B
  B.判断是否满足暗送条件(鱼价值是否小于暗送池并且累计HIT次数取模10等于0)
  不满足则捕获失败，并结束return，满足则继续执行C
  C.尝试暗送捕获(1/FishValue 暗送固定倍数为1)
  捕获成功则消耗暗送池值(鱼分值)，重置暗送累计HIT次数为0，结束并return
  捕获失败则结束并return
}
```
根据上述流程我们将捕获结算类型分为四类
```
1.正常捕获成功 结果:捕获成功
2.正常捕获失败且不满足暗送条件 结果:捕获失败
3.正常捕获失败且满足暗送条件但暗送捕获失败 结果:捕获失败
4.正常捕获失败且满足暗送条件但暗送捕获成功 结果:捕获成功
```

在捕获函数 captureProbability 里 添加四行日志 格式如下
```
暗送分析 玩家id:%d 子弹id:%d 是否双倍:%t 鱼分值:%d 子弹倍率:%d 消耗:%d 正常捕获:%t 暗送条件:%t 暗送捕获:%t 捕获结果:%t 结算类型:%d 结算金币:%d  当前金币:%d 暗送池值:%d 累计HIT次数:%d
```
这样可以很方便品质验证单倍模式、双倍模式下 触发暗送是否正常。


### 刮刮卡测试

### 个人抽奖测试

### 充值测试
充值测试是游戏的关键性测试。
- 理解游戏充值机制(决定了测试方法及验证机制)
- 进可能早的

## 服务器测试

### 单元测试

### 数据测试



### 封包测试

### 压力测试

### 跑数据测试


## 测试环境
### 内网测试环境

### 预发布测试环境

### 线上测试环境

## 其它
### 模拟通知测试

充值通知

1.充值兑换金币后，玩家金币是否实时刷新并数值正确，并同步到桌子里，如果vip也发生变化也有进行相应同步
http:127.0.0.1:8100   post
```
<?xml version="1.0" encoding="utf-8"?>
<req code="sys_sy">
  <msg code="4" id="0">
    <prop type="2" gameID="10087" userid="455666" fee="23" CYMoney="100" />
  </msg>
</req>

## 小结

